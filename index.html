<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manajemen Sistem Kesiswaan - Tema Modern</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        /* Variabel Warna */
        :root {
            --bg-color: #e0e5ec; /* Warna latar belakang utama untuk efek 3D */
            --primary-blue: #007bff; /* Warna tombol/highlight default */
            --dark-text: #343a40;
            /* Bayangan untuk efek 3D menonjol */
            --shadow-light: #ffffff;
            --shadow-dark: #a3b1c6;
            --protruding-shadow: 6px 6px 12px var(--shadow-dark), -6px -6px 12px var(--shadow-light);
            --inset-shadow: inset 6px 6px 12px var(--shadow-dark), inset -6px -6px 12px var(--shadow-light);
            --widget-radius: 18px; /* Sudut membulat yang lebih besar */
        }

        /* Reset dan Layout Dasar */
        html, body {
            height: 100%;
            margin: 0;
            background-color: var(--bg-color); 
            font-family: 'Poppins', sans-serif;
            color: var(--dark-text);
        }

        body {
            display: flex;
            flex-direction: column;
        }

        main {
            flex: 1 0 auto;
            padding-top: 80px; /* Memberi ruang untuk navbar fixed-top */
            padding-bottom: 40px; 
        }

        /* Navbar Styling - Diubah menjadi kontras lembut */
        .navbar {
            /* Properti posisi sekarang diatur oleh kelas .fixed-top Bootstrap */
            background-color: var(--bg-color) !important;
            box-shadow: var(--protruding-shadow);
            color: var(--dark-text);
        }
        .navbar-brand strong {
            color: var(--dark-text);
        }
        .navbar-brand img {
            width: 40px;
            height: 40px;
            padding: 5px; /* Memberi jarak antara logo dan bayangan */
            background-color: var(--bg-color);
            border-radius: 50%;
            box-shadow: var(--protruding-shadow);
            object-fit: cover;
        }
        .navbar-toggler {
            border: none;
            background-color: var(--bg-color);
            box-shadow: var(--protruding-shadow);
            border-radius: 10px;
            padding: 0.5rem 0.75rem;
            transition: box-shadow 0.2s ease;
        }
        .navbar-toggler:hover, .navbar-toggler:focus {
            box-shadow: var(--inset-shadow);
            outline: none;
        }

        /* Offcanvas Menu Styling - Tetap gelap untuk kontras yang baik */
        .offcanvas.offcanvas-end {
            background-color: var(--bg-color); /* Ubah background agar senada */
            color: var(--dark-text);
        }
        .offcanvas-header {
            background-color: var(--bg-color); 
            border-bottom: 1px solid var(--shadow-dark);
            color: var(--dark-text);
        }
        .btn-close.btn-close-white {
            filter: brightness(100%);
        }
        .user-card {
            padding: 1.5rem;
            text-align: center;
            margin: 1rem;
            border-radius: var(--widget-radius);
            box-shadow: var(--inset-shadow); /* Memberi efek cekung pada card */
            color: var(--dark-text);
        }

        .user-card #user-avatar {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 50%;
            margin-bottom: 1rem;
            box-shadow: var(--protruding-shadow);
            padding: 5px; /* Jarak antara foto dan bayangan */
            background-color: var(--bg-color);
        }

        .user-card .user-name {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

        .user-card .btn, .user-card .btn-login {
            box-shadow: var(--protruding-shadow);
            border: none;
            background-color: var(--bg-color);
            color: var(--dark-text);
            border-radius: 10px;
            padding: 0.5rem 1.2rem;
            transition: box-shadow 0.2s ease;
        }
        .user-card .btn:hover, .user-card .btn-login:hover {
            box-shadow: var(--inset-shadow);
        }
        .user-card #logout-button {
            color: #dc3545; /* Warna merah untuk logout */
        }

        .offcanvas-body .nav-link {
            color: var(--dark-text);
            margin-bottom: 1rem;
            border-radius: 12px;
            box-shadow: var(--protruding-shadow);
            padding-left: 1.5rem; /* DIGESER: Memberi jarak dari tepi kiri */
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .offcanvas-body .nav-link i {
            margin-right: 0.75rem; /* DIGESER: Jarak antara ikon dan teks */
            width: 20px; /* Pastikan ikon punya lebar tetap agar rapi */
            text-align: center;
        }
        .offcanvas-body .nav-link:hover,
        .offcanvas-body .nav-link:focus {
            box-shadow: var(--inset-shadow);
            transform: translateY(2px);
        }
        .offcanvas-body .nav-link.active {
            color: var(--primary-blue); 
            box-shadow: var(--inset-shadow);
            font-weight: 600;
        }

        /* Header Utama */
        .main-title {
            font-size: 2.25rem;
            font-weight: 600;
            color: #171a1d; /* Warna teks lebih gelap */
            text-shadow: 1px 1px 2px var(--shadow-dark), -1px -1px 2px var(--shadow-light); /* Efek timbul pada teks */
            margin-bottom: 2rem !important;
            text-align: center;
        }
        
        /* Statistik Card Styling (Gaya Widget) */
        .stat-card {
            background-color: var(--bg-color);
            border: none;
            border-radius: var(--widget-radius); 
            box-shadow: var(--protruding-shadow);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            text-align: center;
            height: 100%;
            display: flex; /* Untuk menata konten lebih baik */
            flex-direction: column;
        }

        .stat-card:hover {
            /* Efek ditekan saat hover */
            box-shadow: var(--inset-shadow);
            transform: translateY(2px);
        }

        .stat-card .card-body {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 1.5rem;
        }

        /* Ganti Gambar Perisai dengan Ikon Lingkaran */
        .card-icon-wrapper {
            width: 80px;
            height: 80px;
            margin: 1.5rem auto 1rem;
            background-color: var(--bg-color); /* Latar belakang ikon */
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--inset-shadow); /* Efek cekung */
        }

        .card-icon-wrapper i {
            font-size: 2.5rem;
            color: var(--primary-blue);
        }

        /* Hapus style gambar lama karena diganti ikon */
        .stat-card .card-img-top {
            display: none; 
        }
        
        .stat-card-title {
            font-size: 0.9rem;
            font-weight: 500;
            color: #6c757d; 
            margin-bottom: 0.25rem;
        }

        .stat-card-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--dark-text); 
            margin-bottom: 1rem;
        }

        .stat-card .btn-show-detail {
            border-radius: 12px; /* Sudut membulat */
            background-color: var(--bg-color);
            border: none;
            color: var(--dark-text);
            font-weight: 500;
            box-shadow: var(--protruding-shadow);
            transition: box-shadow 0.2s ease;
        }
        .stat-card .btn-show-detail:hover {
            box-shadow: var(--inset-shadow);
        }

        /* Tombol Lapor Wakasis - Diubah gayanya agar selaras */
        #btn-lapor-wakasis {
            border-radius: 20px; /* Sedikit lebih bulat */
            background-color: var(--bg-color);
            color: #dc3545; /* Warna teks merah untuk urgency */
            border: none;
            /* Bayangan lebih dramatis untuk efek 3D yang lebih menonjol */
            box-shadow: 12px 12px 24px var(--shadow-dark), -12px -12px 24px var(--shadow-light);
            transition: all 0.3s ease;
            font-weight: 700; /* Teks lebih tebal */
            padding: 0.8rem 1.8rem; /* Padding lebih besar */
            font-size: 1.1rem; /* Ukuran font sedikit lebih besar */
        }
        #btn-lapor-wakasis:hover {
            /* Efek ditekan saat di-hover */
            box-shadow: var(--inset-shadow);
            background-color: #dc3545; /* Warna latar merah saat hover */
            color: #ffffff; /* Warna teks dan ikon putih saat hover */
        }

        /* Footer Styling - Diubah agar netral */
        .footer {
            padding: 2rem 0;
            background-color: var(--bg-color); /* Samakan dengan body */
            color: var(--dark-text);
            /* Memberi efek bayangan ke dalam sebagai pemisah dari konten utama */
            box-shadow: var(--inset-shadow); 
        }
        .footer-school-name {
            color: var(--dark-text);
        }
        .footer-school-address {
            color: var(--dark-text);
        }
        .footer .social-icons a {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 50px;  /* Lebar tombol ikon */
            height: 50px; /* Tinggi tombol ikon */
            border-radius: 50%; /* Membuatnya bulat */
            margin: 0 10px;
            font-size: 1.4rem; /* Ukuran ikon di dalam tombol */
            color: var(--dark-text);
            background-color: var(--bg-color);
            box-shadow: var(--protruding-shadow);
            transition: box-shadow 0.2s ease;
        }
        .footer .social-icons a:hover {
            box-shadow: var(--inset-shadow);
        }

        /* Responsif */
        @media (max-width: 576px) {
            .stat-card-number {
                font-size: 1.75rem;
            }
        }
    </style>
    <style>
        /* Neumorphic Modal Style */
        .modal-content {
            background-color: var(--bg-color);
            border: none;
            border-radius: var(--widget-radius);
            box-shadow: none; /* Menghapus bayangan agar sama seperti modal admin */
        }

        .modal-header {
            background-color: var(--bg-color);
            border-bottom: 1px solid var(--shadow-dark);
            color: var(--dark-text);
        }

        .modal-header .modal-title {
            text-shadow: 1px 1px 1px var(--shadow-dark), -1px -1px 1px var(--shadow-light);
        }

        .modal-footer {
            background-color: var(--bg-color);
            border-top: 1px solid var(--shadow-dark);
        }

        .modal-body .form-control,
        .modal-body .form-select {
            background-color: var(--bg-color);
            border: none;
            border-radius: 10px;
            box-shadow: var(--inset-shadow);
            color: var(--dark-text);
            transition: box-shadow 0.2s ease;
        }

        .modal-body .form-control:focus,
        .modal-body .form-select:focus {
            box-shadow: var(--inset-shadow), 0 0 0 0.25rem rgba(0, 123, 255, 0.25);
        }

        .modal-footer .btn {
            border: none;
            border-radius: 10px;
            box-shadow: var(--protruding-shadow);
            background-color: var(--bg-color);
            color: var(--dark-text);
            transition: box-shadow 0.2s ease;
        }

        .modal-footer .btn:hover {
            box-shadow: var(--inset-shadow);
        }

        .modal-footer .btn-primary {
            color: var(--primary-blue);
            font-weight: 600;
        }
    </style>
</head>
<body>

    <header>
        <nav class="navbar navbar-light bg-light fixed-top"> 
            <div class="container-fluid">
                <a class="navbar-brand d-flex align-items-center" href="index.html">
                    <img src="logo.png" alt="Logo Sekolah" class="me-2">
                    <strong>Manajemen Kesiswaan</strong>
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" title="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
        </nav>
    </header>

    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasNavbarLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasNavbarLabel">Menu Utama</h5>
            <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div class="user-card p-3 text-center">
                <img id="user-avatar" src="logo.png" alt="Foto User">
                <div id="user-info" class="d-none mt-3">
                    <div class="user-name mb-3">Nama Pengguna</div>
                    <a href="#" id="logout-button" class="btn btn-sm">Logout</a>
                </div>
                <div id="login-prompt" class="mt-3">
                    <button type="button" class="btn btn-sm btn-login" data-bs-toggle="modal" data-bs-target="#loginModal">Login</button>
                </div>
            </div>

            <ul class="navbar-nav justify-content-end flex-grow-1 p-3">
                <li class="nav-item"><a class="nav-link active" href="index.html"><i class="fa-solid fa-home"></i> Beranda</a></li>
                <li id="admin-menu-item" class="nav-item d-none"><a class="nav-link" href="pengaturanadmin.html"><i class="fa-solid fa-user-shield"></i> Pengaturan Administrator</a></li>
                <li id="identitas-sekolah-menu-item" class="nav-item d-none"><a class="nav-link" href="identitas.html"><i class="fa-solid fa-school"></i> Identitas Sekolah</a></li>
                <li id="profil-waka-menu-item" class="nav-item d-none"><a class="nav-link" href="wakasis.html"><i class="fa-solid fa-user-tie"></i> Profil Waka Kesiswaan</a></li>
                <li id="pengaturan-data-menu-item" class="nav-item d-none"><a class="nav-link" href="pengaturandata.html"><i class="fa-solid fa-database"></i> Pengaturan Data</a></li>
                <li class="nav-item"><a class="nav-link" href="datasiswa.html"><i class="fa-solid fa-users"></i> Data Siswa</a></li>
                <li class="nav-item"><a class="nav-link" href="prestasi.html"><i class="fa-solid fa-trophy"></i> Prestasi Siswa</a></li>
                <li class="nav-item"><a class="nav-link" href="bantuan.html"><i class="fa-solid fa-hand-holding-heart"></i> Bantuan Pendidikan</a></li>
                <li class="nav-item"><a class="nav-link" href="putussekolah.html"><i class="fa-solid fa-user-slash"></i> Putus Sekolah</a></li>
                <li class="nav-item"><a class="nav-link" href="mutasi.html"><i class="fa-solid fa-right-left"></i> Mutasi</a></li>
                <li class="nav-item"><a class="nav-link" href="alumni.html"><i class="fa-solid fa-user-graduate"></i> Alumni</a></li>
                <li class="nav-item"><a class="nav-link" href="pemanggilan.html"><i class="fa-solid fa-user-group"></i> Pemanggilan Orangtua</a></li>
                <li class="nav-item"><a class="nav-link" href="pembinaan.html"><i class="fa-solid fa-chalkboard-user"></i> Pembinaan Guru/Walas/BK</a></li>
                <li class="nav-item"><a class="nav-link" href="pemanggilan.html"><i class="fa-solid fa-print"></i> Cetak Berkas</a></li>
            </ul>
        </div>
    </div>

    <main class="container">
        <h1 class="main-title">MANAJEMEN INFORMASI KESISWAAN</h1>
        <div class="row g-4">
            <div class="col-lg-3 col-md-6 col-12">
                <div class="stat-card">
                    <div class="card-icon-wrapper"><i class="fas fa-user-friends"></i></div> 
                    <div class="card-body">
                        <div>
                            <h5 class="stat-card-title">TOTAL SISWA</h5>
                            <p class="stat-card-number" id="total-siswa-stat">Belum ada data</p>
                        </div>
                        <button class="btn btn-sm btn-show-detail" data-detail-type="siswa">Lihat Detail</button>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-12">
                <div class="stat-card">
                    <div class="card-icon-wrapper"><i class="fas fa-trophy"></i></div>
                    <div class="card-body">
                        <div>
                            <h5 class="stat-card-title">PRESTASI</h5>
                            <p class="stat-card-number" id="total-prestasi-stat">Belum ada data</p>
                        </div>
                        <button class="btn btn-sm btn-show-detail" data-detail-type="prestasi">Lihat Detail</button>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-12">
                <div class="stat-card">
                    <div class="card-icon-wrapper"><i class="fas fa-hand-holding-heart"></i></div>
                    <div class="card-body">
                        <div>
                            <h5 class="stat-card-title">BANTUAN PENDIDIKAN</h5>
                            <p class="stat-card-number" id="total-bantuan-stat">Belum ada data</p>
                        </div>
                        <button class="btn btn-sm btn-show-detail" data-detail-type="bantuan">Lihat Detail</button>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-12">
                <div class="stat-card">
                    <div class="card-icon-wrapper"><i class="fas fa-user-slash"></i></div>
                    <div class="card-body">
                        <div>
                            <h5 class="stat-card-title">PUTUS SEKOLAH</h5>
                            <p class="stat-card-number" id="total-do-stat">Belum ada data</p>
                        </div>
                        <button class="btn btn-sm btn-show-detail" data-detail-type="putus-sekolah">Lihat Detail</button>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-12">
                <div class="stat-card">
                    <div class="card-icon-wrapper"><i class="fas fa-right-left"></i></div>
                    <div class="card-body">
                        <div>
                            <h5 class="stat-card-title">MUTASI</h5>
                            <p class="stat-card-number" id="total-mutasi-stat">Belum ada data</p>
                        </div>
                        <button class="btn btn-sm btn-show-detail" data-detail-type="mutasi">Lihat Detail</button>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 col-12">
                <div class="stat-card">
                    <div class="card-icon-wrapper"><i class="fas fa-user-graduate"></i></div>
                    <div class="card-body">
                        <div>
                            <h5 class="stat-card-title">ALUMNI</h5>
                            <p class="stat-card-number" id="total-alumni-stat">Belum ada data</p>
                        </div>
                        <button class="btn btn-sm btn-show-detail" data-detail-type="alumni">Lihat Detail</button>
                    </div>
                </div>
            </div>
            </div>

        <div class="text-center mt-5">
            <button type="button" id="btn-lapor-wakasis" class="btn btn-danger btn-lg shadow-lg"><i class="fas fa-bullhorn me-2"></i>LAPOR WAKASIS..!!</button>
        </div>
    </main>

    <!-- Modal Info Login Diperlukan (BARU) -->
    <div class="modal fade" id="loginRequiredModal" tabindex="-1" aria-labelledby="loginRequiredModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content"> <!-- Modal ini juga akan terpengaruh oleh style baru -->
                <div class="modal-header bg-warning text-dark">
                    <h5 class="modal-title" id="loginRequiredModalLabel"><i class="fas fa-exclamation-triangle me-2"></i>Akses Dibatasi</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="text-center fs-5">Silahkan login terlebih dahulu untuk menggunakan fitur ini.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn" data-bs-dismiss="modal">Tutup</button>
                    <button type="button" class="btn btn-primary" id="btn-login-from-info" data-bs-toggle="modal" data-bs-target="#loginModal">
                        Login Sekarang
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content"> <!-- Modal ini juga akan terpengaruh oleh style baru -->
                <div class="modal-header">
                    <h5 class="modal-title" id="loginModalLabel">Login Administrator</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="login-error" class="alert alert-danger d-none" role="alert">
                        Username atau password salah.
                    </div>
                    <form id="login-form">
                        <div class="mb-3">
                            <label for="login-username" class="form-label">Username</label>
                            <select class="form-select" id="login-username" required autocomplete="username">
                                <option value="" selected disabled>Pilih username...</option>
                                </select>
                        </div>
                        <div class="mb-3">
                            <label for="login-password" class="form-label">Password</label>
                            <div class="input-group">
                                <input type="password" class="form-control" id="login-password" required>
                                <button class="btn btn-outline-secondary" type="button" id="togglePassword" title="Tampilkan/Sembunyikan password"><i class="fas fa-eye"></i></button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
                    <button type="submit" form="login-form" class="btn btn-primary" id="login-button">Login</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="pembinaanModal" tabindex="-1" aria-labelledby="pembinaanModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content"> <!-- Modal ini juga akan terpengaruh oleh style baru -->
                <div class="modal-header">
                    <h5 class="modal-title" id="pembinaanModalLabel">Lapor / Input Data Pembinaan</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form id="form-pembinaan">
                    <div class="modal-body">
                        <div class="row g-3">
                            <div class="col-md-6">
                                <h6 class="mb-3 text-primary">Data Siswa</h6>
                                <div class="mb-3">
                                    <label for="pembinaan-nama_siswa" class="form-label">Nama Siswa</label>
                                    <input type="text" class="form-control" id="pembinaan-nama_siswa" required>
                                </div>
                                <div class="mb-3">
                                    <label for="pembinaan-nisn" class="form-label">NISN</label>
                                    <input type="text" class="form-control" id="pembinaan-nisn">
                                </div>
                                <div class="row">
                                    <div class="col-sm-6 mb-3">
                                        <label for="pembinaan-kelas" class="form-label">Kelas</label>
                                        <select class="form-select" id="pembinaan-kelas">
                                            <option value="" selected disabled>Memuat kelas...</option>
                                        </select>
                                    </div>
                                    <div class="col-sm-6 mb-3">
                                        <label for="pembinaan-jurusan" class="form-label">Jurusan</label>
                                        <select class="form-select" id="pembinaan-jurusan">
                                            <option value="" selected disabled>Memuat jurusan...</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label for="pembinaan-topik_permasalahan" class="form-label">Topik Permasalahan</label>
                                    <textarea class="form-control" id="pembinaan-topik_permasalahan" rows="3" required></textarea>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h6 class="mb-3 text-primary">Detail Pembinaan</h6>
                                <div class="row">
                                    <div class="col-sm-6 mb-3">
                                        <label for="pembinaan-tanggal_pembinaan" class="form-label">Tanggal Pembinaan</label>
                                        <input type="date" class="form-control" id="pembinaan-tanggal_pembinaan" required>
                                    </div>
                                    <div class="col-sm-6 mb-3">
                                        <label for="pembinaan-waktu_pembinaan" class="form-label">Waktu Pembinaan</label>
                                        <input type="time" class="form-control" id="pembinaan-waktu_pembinaan">
                                    </div>
                                </div>
                                <div class="mb-3">
                                    <label for="pembinaan-tempat_pembinaan" class="form-label">Tempat Pembinaan</label>
                                    <input type="text" class="form-control" id="pembinaan-tempat_pembinaan" placeholder="Contoh: Ruang BK">
                                </div>
                                <div class="mb-3">
                                    <label for="pembinaan-rekomendasi" class="form-label">Rekomendasi Guru/Walas/BK</label>
                                    <textarea class="form-control" id="pembinaan-rekomendasi" rows="3"></textarea>
                                </div>
                                <div class="mb-3">
                                    <label for="pembinaan-mengetahui_walikelas" class="form-label">Mengetahui Wali Kelas</label>
                                    <select class="form-select" id="pembinaan-mengetahui_walikelas">
                                        <option value="" selected disabled>Memuat wali kelas...</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="mt-3">
                            <label for="pembinaan-upload_photo" class="form-label">Upload Photo Pembinaan (Opsional)</label>
                            <input class="form-control" type="file" id="pembinaan-upload_photo" accept="image/png,image/jpeg">
                            <div class="form-text">Maksimal ukuran file: 1MB.</div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn" data-bs-dismiss="modal">Batal</button>
                        <button type="submit" class="btn btn-primary" id="btn-konfirmasi-pembinaan">Konfirmasi & Lapor</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="modal fade" id="detailModal" tabindex="-1" aria-labelledby="detailModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content"> <!-- Modal ini juga akan terpengaruh oleh style baru -->
                <div class="modal-header">
                    <h5 class="modal-title" id="detailModalLabel">Rekapitulasi Detail</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="detailModalBody">
                    <div class="text-center">
                        <span class="spinner-border" role="status"></span>
                        <p class="mt-2">Memuat detail...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <div class="container text-center">
            <p id="footer-school-name" class="footer-school-name">Nama Sekolah Anda</p>
            <p id="footer-school-address" class="footer-school-address">Alamat Sekolah</p>
            <div class="social-icons mb-2">
                <a href="#" class="facebook" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                <a href="#" class="twitter" aria-label="Twitter"><i class="fab fa-twitter"></i></a>
                <a href="#" class="instagram" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                <a href="#" class="youtube" aria-label="Youtube"><i class="fab fa-youtube"></i></a>
            </div>
            <div class="col-12 text-center mt-3">
                <small>&copy;Kenji Studio Developer 2025.</small>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <script>
        const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
    </script>
    <script src="global.js"></script>
    <script>
        // Fungsi baru untuk memuat statistik di halaman utama
        async function loadDashboardStats() {
            try {
                // Mengambil data secara paralel untuk performa yang lebih baik
                const [siswaRes, prestasiRes, bantuanRes, doRes, mutasiRes, alumniRes] = await Promise.all([
                    supabaseClient.from('tabelsiswa').select('*', { count: 'exact', head: true }),
                    supabaseClient.from('tabelprestasi').select('*', { count: 'exact', head: true }),
                    supabaseClient.from('tabelbantuan').select('*', { count: 'exact', head: true }),
                    supabaseClient.from('tabelputussekolah').select('*', { count: 'exact', head: true }), // Asumsi nama tabel
                    supabaseClient.from('tabelmutasi').select('*', { count: 'exact', head: true }),
                    supabaseClient.from('tabelalumni').select('*', { count: 'exact', head: true })
                ]);

                // Update kartu Total Siswa
                const totalSiswaStat = document.getElementById('total-siswa-stat');
                if (siswaRes.error) throw { element: totalSiswaStat, error: siswaRes.error };
                totalSiswaStat.textContent = siswaRes.count > 0 ? siswaRes.count.toLocaleString('id-ID') : 'Belum ada data';

                // Update kartu Prestasi
                const totalPrestasiStat = document.getElementById('total-prestasi-stat');
                if (prestasiRes.error) throw { element: totalPrestasiStat, error: prestasiRes.error };
                totalPrestasiStat.textContent = prestasiRes.count > 0 ? prestasiRes.count.toLocaleString('id-ID') : 'Belum ada data';

                // Update kartu Bantuan
                const totalBantuanStat = document.getElementById('total-bantuan-stat');
                if (bantuanRes.error) throw { element: totalBantuanStat, error: bantuanRes.error };
                totalBantuanStat.textContent = bantuanRes.count > 0 ? bantuanRes.count.toLocaleString('id-ID') : 'Belum ada data';

                // Update kartu Putus Sekolah
                const totalDoStat = document.getElementById('total-do-stat');
                if (doRes.error) throw { element: totalDoStat, error: doRes.error };
                totalDoStat.textContent = doRes.count > 0 ? doRes.count.toLocaleString('id-ID') : 'Belum ada data';

                // Update kartu Mutasi
                const totalMutasiStat = document.getElementById('total-mutasi-stat');
                if (mutasiRes.error) throw { element: totalMutasiStat, error: mutasiRes.error };
                totalMutasiStat.textContent = mutasiRes.count > 0 ? mutasiRes.count.toLocaleString('id-ID') : 'Belum ada data';

                // Update kartu Alumni
                const totalAlumniStat = document.getElementById('total-alumni-stat');
                if (alumniRes.error) throw { element: totalAlumniStat, error: alumniRes.error };
                totalAlumniStat.textContent = alumniRes.count > 0 ? alumniRes.count.toLocaleString('id-ID') : 'Belum ada data';

            } catch (errorInfo) {
                console.error('Gagal memuat statistik:', errorInfo.error.message);
                if (errorInfo.element) {
                    errorInfo.element.textContent = 'Error';
                    errorInfo.element.title = errorInfo.error.message;
                }
            }
        }

        // --- FUNGSI UNTUK MODAL PEMBINAAN ---
        const pembinaanModal = new bootstrap.Modal(document.getElementById('pembinaanModal'));
        const formPembinaan = document.getElementById('form-pembinaan');

        async function populatePembinaanDropdowns() {
            const kelasSelect = document.getElementById('pembinaan-kelas');
            const jurusanSelect = document.getElementById('pembinaan-jurusan');
            const walikelasSelect = document.getElementById('pembinaan-mengetahui_walikelas');
            
            try {
                const { data, error } = await supabaseClient.from('tabelpengaturan').select('kelas, jurusan, walikelas');
                if (error) throw error;

                const uniqueKelas = [...new Set(data.map(item => item.kelas).filter(Boolean))].sort();
                const uniqueJurusan = [...new Set(data.map(item => item.jurusan).filter(Boolean))].sort();
                const uniqueWaliKelas = [...new Set(data.map(item => item.walikelas).filter(Boolean))].sort();

                kelasSelect.innerHTML = '<option value="">Pilih Kelas...</option>';
                uniqueKelas.forEach(opt => { kelasSelect.innerHTML += `<option value="${opt}">${opt}</option>`; });

                jurusanSelect.innerHTML = '<option value="">Pilih Jurusan...</option>';
                uniqueJurusan.forEach(opt => { jurusanSelect.innerHTML += `<option value="${opt}">${opt}</option>`; });

                walikelasSelect.innerHTML = '<option value="">Pilih Wali Kelas...</option>';
                uniqueWaliKelas.forEach(opt => { walikelasSelect.innerHTML += `<option value="${opt}">${opt}</option>`; });

            } catch (error) {
                console.error('Gagal memuat data dropdown pembinaan:', error);
            }
        }

        formPembinaan.addEventListener('submit', async (event) => {
            event.preventDefault();
            const btnKonfirmasi = document.getElementById('btn-konfirmasi-pembinaan');
            btnKonfirmasi.disabled = true;
            btnKonfirmasi.innerHTML = '<span class="spinner-border spinner-border-sm"></span> Menyimpan...';

            const photoFile = document.getElementById('pembinaan-upload_photo').files[0];
            let photoUrl = null;

            if (photoFile) {
                if (photoFile.size > 1 * 1024 * 1024) {
                    alert('Ukuran file tidak boleh melebihi 1MB.');
                    btnKonfirmasi.disabled = false;
                    btnKonfirmasi.innerHTML = 'Konfirmasi & Lapor';
                    return;
                }
                const filePath = `photo-pembinaan/${Date.now()}-${photoFile.name}`;
                const { error: uploadError } = await supabaseClient.storage.from('aset').upload(filePath, photoFile);
                if (uploadError) {
                    alert('Gagal mengunggah foto: ' + uploadError.message);
                    btnKonfirmasi.disabled = false;
                    btnKonfirmasi.innerHTML = 'Konfirmasi & Lapor';
                    return;
                }
                const { data: urlData } = supabaseClient.storage.from('aset').getPublicUrl(filePath);
                photoUrl = urlData.publicUrl;
            }

            const dataToInsert = {
                nama_siswa: document.getElementById('pembinaan-nama_siswa').value,
                nisn: document.getElementById('pembinaan-nisn').value,
                kelas: document.getElementById('pembinaan-kelas').value,
                jurusan: document.getElementById('pembinaan-jurusan').value,
                tanggal: document.getElementById('pembinaan-tanggal_pembinaan').value,
                waktu: document.getElementById('pembinaan-waktu_pembinaan').value,
                tempat: document.getElementById('pembinaan-tempat_pembinaan').value,
                topik_masalah: document.getElementById('pembinaan-topik_permasalahan').value,
                rekomendasi: document.getElementById('pembinaan-rekomendasi').value,
                walikelas: document.getElementById('pembinaan-mengetahui_walikelas').value,
                photo_kegiatan: photoUrl
            };

            const { error } = await supabaseClient.from('tabelpembinaan').insert([dataToInsert]);

            if (error) {
                alert('Gagal menyimpan data: ' + error.message);
            } else {
                alert('Laporan pembinaan berhasil dikirim!');
                pembinaanModal.hide();
            }

            btnKonfirmasi.disabled = false;
            btnKonfirmasi.innerHTML = 'Konfirmasi & Lapor';
        });

        // --- FUNGSI UNTUK MODAL DETAIL REKAP ---
        const detailModal = new bootstrap.Modal(document.getElementById('detailModal'));
        const detailModalBody = document.getElementById('detailModalBody');
        const detailModalLabel = document.getElementById('detailModalLabel');

        async function showDetailModal(detailType) {
            detailModalLabel.textContent = 'Memuat...';
            detailModalBody.innerHTML = `<div class="text-center"><span class="spinner-border"></span><p class="mt-2">Memuat detail...</p></div>`;
            detailModal.show();

            let contentHtml = '';
            let data, error;

            try {
                switch (detailType) {
                    case 'siswa':
                        detailModalLabel.textContent = 'Rekapitulasi Data Siswa';
                        ({ data, error } = await supabaseClient.from('tabelsiswa').select('*'));
                        if (error) throw error;
                        contentHtml = generateSiswaRekapHtml(data);
                        break;

                    case 'prestasi':
                        detailModalLabel.textContent = 'Rekapitulasi Data Prestasi';
                        ({ data, error } = await supabaseClient.from('tabelprestasi').select('*'));
                        if (error) throw error;
                        contentHtml = generatePrestasiRekapHtml(data);
                        break;

                    case 'bantuan':
                        detailModalLabel.textContent = 'Rekapitulasi Data Bantuan';
                        ({ data, error } = await supabaseClient.from('tabelbantuan').select('*'));
                        if (error) throw error;
                        contentHtml = generateBantuanRekapHtml(data);
                        break;
                    
                    case 'putus-sekolah':
                        detailModalLabel.textContent = 'Rekapitulasi Siswa Putus Sekolah';
                        ({ data, error } = await supabaseClient.from('tabelputussekolah').select('*'));
                        if (error) throw error;
                        contentHtml = generatePutusSekolahRekapHtml(data);
                        break;

                    case 'mutasi':
                        detailModalLabel.textContent = 'Rekapitulasi Data Mutasi';
                        ({ data, error } = await supabaseClient.from('tabelmutasi').select('*'));
                        if (error) throw error;
                        contentHtml = generateMutasiRekapHtml(data);
                        break;

                    case 'alumni':
                        detailModalLabel.textContent = 'Rekapitulasi Data Alumni';
                        ({ data, error } = await supabaseClient.from('tabelalumni').select('*'));
                        if (error) throw error;
                        contentHtml = generateAlumniRekapHtml(data);
                        break;


                    default:
                        contentHtml = '<p class="text-center text-danger">Tipe detail tidak dikenali.</p>';
                }
                detailModalBody.innerHTML = contentHtml;
            } catch (err) {
                console.error('Error loading detail modal:', err);
                detailModalBody.innerHTML = `<p class="text-center text-danger">Gagal memuat detail. Pastikan tabel terkait sudah ada.</p>`;
            }
        }

        function generateSiswaRekapHtml(siswaData) {
            if (siswaData.length === 0) return '<p class="text-center">Belum ada data siswa.</p>';

            const totalSiswa = siswaData.length;
            const jumlahLaki = siswaData.filter(s => s.jenis_kelamin === 'Laki-laki').length;
            const jumlahPerempuan = totalSiswa - jumlahLaki;

            const countFrequency = (arr, key) => arr.reduce((acc, item) => {
                const value = item[key] || 'Tidak Diisi';
                acc[value] = (acc[value] || 0) + 1;
                return acc;
            }, {});

            const agamaCounts = countFrequency(siswaData, 'agama');
            const kelasCounts = countFrequency(siswaData, 'kelas');

            let agamaHtml = Object.keys(agamaCounts).sort().map(key => `<li class="list-group-item d-flex justify-content-between align-items-center">${key} <span class="badge bg-success rounded-pill">${agamaCounts[key]}</span></li>`).join('');
            let kelasHtml = Object.keys(kelasCounts).sort().map(key => `<li class="list-group-item d-flex justify-content-between align-items-center">${key} <span class="badge bg-info rounded-pill">${kelasCounts[key]}</span></li>`).join('');

            return `
                <div class="row g-4">
                    <div class="col-md-4">
                        <h6><i class="fas fa-users me-2 text-primary"></i>Jumlah Siswa</h6>
                        <ul class="list-group">
                            <li class="list-group-item d-flex justify-content-between align-items-center">Total Siswa <span class="badge bg-primary rounded-pill">${totalSiswa}</span></li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">Laki-laki <span class="badge bg-info rounded-pill">${jumlahLaki}</span></li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">Perempuan <span class="badge bg-danger rounded-pill">${jumlahPerempuan}</span></li>
                        </ul>
                    </div>
                    <div class="col-md-4">
                        <h6><i class="fas fa-place-of-worship me-2 text-success"></i>Berdasarkan Agama</h6>
                        <ul class="list-group">${agamaHtml}</ul>
                    </div>
                    <div class="col-md-4">
                        <h6><i class="fas fa-chalkboard-teacher me-2 text-info"></i>Berdasarkan Kelas</h6>
                        <ul class="list-group">${kelasHtml}</ul>
                    </div>
                </div>
            `;
        }

        function generatePrestasiRekapHtml(prestasiData) {
            if (prestasiData.length === 0) return '<p class="text-center">Belum ada data prestasi.</p>';
            const countFrequency = (arr, key) => arr.reduce((acc, item) => { const value = item[key] || 'Tidak Diisi'; acc[value] = (acc[value] || 0) + 1; return acc; }, {});
            const jenjangCounts = countFrequency(prestasiData, 'jenjang');
            const tahunCounts = countFrequency(prestasiData, 'tahun');
            let jenjangHtml = Object.keys(jenjangCounts).sort().map(key => `<li class="list-group-item d-flex justify-content-between align-items-center">${key} <span class="badge bg-success rounded-pill">${jenjangCounts[key]}</span></li>`).join('');
            let tahunHtml = Object.keys(tahunCounts).sort((a, b) => b - a).map(key => `<li class="list-group-item d-flex justify-content-between align-items-center">${key} <span class="badge bg-info rounded-pill">${tahunCounts[key]}</span></li>`).join('');

            return `
                <div class="row g-4">
                    <div class="col-md-6"><h6><i class="fas fa-layer-group me-2 text-success"></i>Berdasarkan Jenjang</h6><ul class="list-group">${jenjangHtml}</ul></div>
                    <div class="col-md-6"><h6><i class="fas fa-calendar-alt me-2 text-info"></i>Berdasarkan Tahun</h6><ul class="list-group">${tahunHtml}</ul></div>
                </div>
            `;
        }

        function generateBantuanRekapHtml(bantuanData) {
            if (bantuanData.length === 0) return '<p class="text-center">Belum ada data bantuan.</p>';
            const countFrequency = (arr, key) => arr.reduce((acc, item) => { const value = item[key] || 'Tidak Diisi'; acc[value] = (acc[value] || 0) + 1; return acc; }, {});
            const jenisCounts = countFrequency(bantuanData, 'jenis_bantuan');
            const tahunCounts = countFrequency(bantuanData, 'tahun');
            const kelasCounts = countFrequency(bantuanData, 'kelas');
            let jenisHtml = Object.keys(jenisCounts).sort().map(key => `<li class="list-group-item d-flex justify-content-between align-items-center">${key} <span class="badge bg-success rounded-pill">${jenisCounts[key]}</span></li>`).join('');
            let tahunHtml = Object.keys(tahunCounts).sort((a, b) => b - a).map(key => `<li class="list-group-item d-flex justify-content-between align-items-center">${key} <span class="badge bg-info rounded-pill">${tahunCounts[key]}</span></li>`).join('');
            let kelasHtml = Object.keys(kelasCounts).sort().map(key => `<li class="list-group-item d-flex justify-content-between align-items-center">${key} <span class="badge bg-warning rounded-pill">${kelasCounts[key]}</span></li>`).join('');

            return `
                <div class="row g-4">
                    <div class="col-md-4"><h6><i class="fas fa-layer-group me-2 text-success"></i>Berdasarkan Jenis</h6><ul class="list-group">${jenisHtml}</ul></div>
                    <div class="col-md-4"><h6><i class="fas fa-chalkboard-teacher me-2 text-warning"></i>Berdasarkan Kelas</h6><ul class="list-group">${kelasHtml}</ul></div>
                    <div class="col-md-4"><h6><i class="fas fa-calendar-alt me-2 text-info"></i>Berdasarkan Tahun</h6><ul class="list-group">${tahunHtml}</ul></div>
                </div>
            `;
        }

        function generatePutusSekolahRekapHtml(putusSekolahData) {
            if (putusSekolahData.length === 0) return '<p class="text-center">Belum ada data siswa putus sekolah.</p>';
            const countFrequency = (arr, key) => arr.reduce((acc, item) => { const value = item[key] || 'Tidak Diisi'; acc[value] = (acc[value] || 0) + 1; return acc; }, {});
            
            const totalSiswa = putusSekolahData.length;
            const jurusanCounts = countFrequency(putusSekolahData, 'jurusan');
            const alasanCounts = countFrequency(putusSekolahData, 'alasan_berhenti');
            const kelasCounts = countFrequency(putusSekolahData, 'berhenti_di_kelas');

            const renderList = (data) => Object.keys(data).sort().map(key => `<li class="list-group-item d-flex justify-content-between align-items-center">${key} <span class="badge bg-secondary rounded-pill">${data[key]}</span></li>`).join('');

            return `
                <div class="row g-4">
                    <div class="col-md-6"><h6><i class="fas fa-users me-2 text-primary"></i>Jumlah Siswa</h6><ul class="list-group"><li class="list-group-item d-flex justify-content-between align-items-center">Total Siswa <span class="badge bg-primary rounded-pill">${totalSiswa}</span></li></ul></div>
                    <div class="col-md-6"><h6><i class="fas fa-sitemap me-2 text-success"></i>Berdasarkan Jurusan</h6><ul class="list-group">${renderList(jurusanCounts)}</ul></div>
                    <div class="col-md-6"><h6><i class="fas fa-question-circle me-2 text-danger"></i>Berdasarkan Alasan</h6><ul class="list-group">${renderList(alasanCounts)}</ul></div>
                    <div class="col-md-6"><h6><i class="fas fa-chalkboard-teacher me-2 text-warning"></i>Berdasarkan Kelas Berhenti</h6><ul class="list-group">${renderList(kelasCounts)}</ul></div>
                </div>
            `;
        }

        function generateMutasiRekapHtml(mutasiData) {
            if (mutasiData.length === 0) return '<p class="text-center">Belum ada data mutasi.</p>';
            const countFrequency = (arr, key) => arr.reduce((acc, item) => { const value = item[key] || 'Tidak Diisi'; acc[value] = (acc[value] || 0) + 1; return acc; }, {});
            const jurusanCounts = countFrequency(mutasiData, 'jurusan');
            const tahunCounts = countFrequency(mutasiData, 'tahun_pelajaran');
            const renderList = (data) => Object.keys(data).sort().map(key => `<li class="list-group-item d-flex justify-content-between align-items-center">${key} <span class="badge bg-secondary rounded-pill">${data[key]}</span></li>`).join('');

            return `
                <div class="row g-4">
                    <div class="col-md-6"><h6><i class="fas fa-sitemap me-2 text-success"></i>Berdasarkan Jurusan</h6><ul class="list-group">${renderList(jurusanCounts)}</ul></div>
                    <div class="col-md-6"><h6><i class="fas fa-calendar-alt me-2 text-info"></i>Berdasarkan Tahun Pelajaran</h6><ul class="list-group">${renderList(tahunCounts)}</ul></div>
                </div>
            `;
        }

        function generateAlumniRekapHtml(alumniData) {
            if (alumniData.length === 0) return '<p class="text-center">Belum ada data alumni.</p>';
            const countFrequency = (arr, key) => arr.reduce((acc, item) => { const value = item[key] || 'Tidak Diisi'; acc[value] = (acc[value] || 0) + 1; return acc; }, {});
            const jurusanCounts = countFrequency(alumniData, 'jurusan');
            const tahunCounts = countFrequency(alumniData, 'tahun_lulus');
            const renderList = (data) => Object.keys(data).sort((a, b) => b - a).map(key => `<li class="list-group-item d-flex justify-content-between align-items-center">${key} <span class="badge bg-secondary rounded-pill">${data[key]}</span></li>`).join('');

            return `
                <div class="row g-4">
                    <div class="col-md-6"><h6><i class="fas fa-sitemap me-2 text-warning"></i>Berdasarkan Jurusan</h6><ul class="list-group">${renderList(jurusanCounts)}</ul></div>
                    <div class="col-md-6"><h6><i class="fas fa-calendar-check me-2 text-success"></i>Berdasarkan Tahun Lulus</h6><ul class="list-group">${renderList(tahunCounts)}</ul></div>
                </div>
            `;
        }


        // Panggil fungsi saat halaman dimuat
        document.addEventListener('DOMContentLoaded', () => {
            checkLoginStatus();
            loadSchoolIdentity(); // Kembali gunakan fungsi dari global.js
            loadDashboardStats(); // Panggil fungsi untuk memuat statistik
            populateLoginUsernames(); // Panggil fungsi untuk mengisi dropdown username login
            populatePembinaanDropdowns(); // Panggil fungsi untuk mengisi dropdown modal pembinaan

            // Logika untuk menu hamburger berdasarkan status login
            const navMenu = document.querySelector('.offcanvas-body .navbar-nav');
            navMenu.addEventListener('click', function(event) {
                const link = event.target.closest('.nav-link');
                if (!link) return;

                const userAvatar = document.getElementById('user-avatar');
                const href = link.getAttribute('href');

                // Jika foto profil kosong (belum login) dan link BUKAN Beranda/anchor
                if (!userAvatar.src && href !== 'index.html' && href !== '#') {
                    // Cegah navigasi dan tampilkan pesan
                    event.preventDefault();
                    alert('Silahkan Login Terlebih Dahulu');
                }
            });

            // Event listener untuk semua tombol "Lihat Detail"
            document.querySelectorAll('.btn-show-detail').forEach(button => {
                button.addEventListener('click', function() {
                    const detailType = this.dataset.detailType;
                    showDetailModal(detailType);
                });
            });

            // Event listener untuk tombol "Lapor Wakasis"
            document.getElementById('btn-lapor-wakasis').addEventListener('click', function() {
                const isLoggedIn = sessionStorage.getItem('loggedInUser');
                if (isLoggedIn) {
                    formPembinaan.reset(); // Selalu reset form saat dibuka dari sini
                    pembinaanModal.show();
                } else {
                    const loginRequiredModal = new bootstrap.Modal(document.getElementById('loginRequiredModal'));
                    loginRequiredModal.show(); // Tampilkan modal notifikasi
                }
            });
        });

        // Fungsi untuk memindahkan fokus dengan tombol Enter
        function handleEnterAsTab(formElement) {
            if (!formElement) return; // Pengaman jika form tidak ditemukan
            const focusableElements = Array.from(formElement.querySelectorAll('input, select, textarea, button:not([type="button"][data-bs-dismiss])'));
            formElement.addEventListener('keydown', (event) => {
                if (event.key === 'Enter' && event.target.tagName !== 'TEXTAREA') {
                    event.preventDefault();
                    const currentIndex = focusableElements.indexOf(event.target);
                    const nextIndex = currentIndex + 1;
                    if (nextIndex < focusableElements.length) {
                        // Jangan submit jika menekan enter di input terakhir, tapi fokuskan ke tombol login
                        if (focusableElements[nextIndex].type === 'submit' || focusableElements[nextIndex].id === 'login-button') {
                             focusableElements[nextIndex].focus();
                        } else {
                            focusableElements[nextIndex].focus();
                        }
                    }
                }
            });
        }
        const loginForm = document.getElementById('login-form');
        handleEnterAsTab(loginForm);
    </script>
</body>
</html>